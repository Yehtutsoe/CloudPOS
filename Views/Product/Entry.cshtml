@model Tuple<ProductViewModel,PriceViewModel>

<h2 class="mt-1">Product Entry Form</h2>
<form action="/product/entry" method="post" enctype="multipart/form-data">
    <div class="col-md-4">
        <label class="form-label">Code</label>
        <input type="text" name="ProductViewModel.Code" value="@Model.Item1.Code" readonly class="form-control" />
    </div>
    
    <button class="btn btn-primary" type="submit"><i class="fa-solid fa-floppy-disk"></i>Save</button>
    <a href="/product/list" class="btn btn-warning"><i class="fa fa-window-close"></i>Cancel</a>
</form>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
@section Scripts{

    <script>
                $(document).ready(function() {
            // When the Category dropdown changes
            $('#CategoryId').change(function() {
                var categoryId = $(this).val(); // Get selected Category ID
                if (categoryId) {
                    $.ajax({
                        url: '/product/GetBrandByCategory',
                        type: 'GET',
                        data: { categoryId: categoryId },
                        success: function(data) {
                            console.log("Brands data: ", data);  // Debugging the received data

                            var brandSelect = $('#BrandId');
                            brandSelect.empty();  // Clear existing brands
                            brandSelect.append('<option value=""> [ Select One ]</option>');  // Default option

                            // Check if the data is not empty and populate the dropdown
                            if (data.length > 0) {
                                $.each(data, function(index, brand) {
                                    brandSelect.append('<option value="' + brand.value + '">' + brand.text + '</option>');
                                });
                            } else {
                                brandSelect.append('<option value="">No Brands Available</option>');
                            }
                        },
                        error: function() {
                            alert('Failed to load brands.');
                        }
                    });
                }
            });
        });
    </script>
}



